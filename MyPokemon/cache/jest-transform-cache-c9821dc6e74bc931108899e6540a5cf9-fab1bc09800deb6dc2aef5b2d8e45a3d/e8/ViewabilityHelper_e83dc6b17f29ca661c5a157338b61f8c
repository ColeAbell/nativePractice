65763e7a7024d916611ef5d0b381efba
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var invariant = require('invariant');
var ViewabilityHelper = function () {
  function ViewabilityHelper() {
    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
      viewAreaCoveragePercentThreshold: 0
    };
    (0, _classCallCheck2.default)(this, ViewabilityHelper);
    this._hasInteracted = false;
    this._timers = new Set();
    this._viewableIndices = [];
    this._viewableItems = new Map();
    this._config = config;
  }
  (0, _createClass2.default)(ViewabilityHelper, [{
    key: "dispose",
    value: function dispose() {
      this._timers.forEach(clearTimeout);
    }
  }, {
    key: "computeViewableItems",
    value: function computeViewableItems(props, scrollOffset, viewportHeight, getFrameMetrics, renderRange) {
      var itemCount = props.getItemCount(props.data);
      var _this$_config = this._config,
        itemVisiblePercentThreshold = _this$_config.itemVisiblePercentThreshold,
        viewAreaCoveragePercentThreshold = _this$_config.viewAreaCoveragePercentThreshold;
      var viewAreaMode = viewAreaCoveragePercentThreshold != null;
      var viewablePercentThreshold = viewAreaMode ? viewAreaCoveragePercentThreshold : itemVisiblePercentThreshold;
      invariant(viewablePercentThreshold != null && itemVisiblePercentThreshold != null !== (viewAreaCoveragePercentThreshold != null), 'Must set exactly one of itemVisiblePercentThreshold or viewAreaCoveragePercentThreshold');
      var viewableIndices = [];
      if (itemCount === 0) {
        return viewableIndices;
      }
      var firstVisible = -1;
      var _ref = renderRange || {
          first: 0,
          last: itemCount - 1
        },
        first = _ref.first,
        last = _ref.last;
      if (last >= itemCount) {
        console.warn('Invalid render range computing viewability ' + JSON.stringify({
          renderRange: renderRange,
          itemCount: itemCount
        }));
        return [];
      }
      for (var idx = first; idx <= last; idx++) {
        var metrics = getFrameMetrics(idx, props);
        if (!metrics) {
          continue;
        }
        var top = metrics.offset - scrollOffset;
        var bottom = top + metrics.length;
        if (top < viewportHeight && bottom > 0) {
          firstVisible = idx;
          if (_isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, metrics.length)) {
            viewableIndices.push(idx);
          }
        } else if (firstVisible >= 0) {
          break;
        }
      }
      return viewableIndices;
    }
  }, {
    key: "onUpdate",
    value: function onUpdate(props, scrollOffset, viewportHeight, getFrameMetrics, createViewToken, onViewableItemsChanged, renderRange) {
      var _this = this;
      var itemCount = props.getItemCount(props.data);
      if (this._config.waitForInteraction && !this._hasInteracted || itemCount === 0 || !getFrameMetrics(0, props)) {
        return;
      }
      var viewableIndices = [];
      if (itemCount) {
        viewableIndices = this.computeViewableItems(props, scrollOffset, viewportHeight, getFrameMetrics, renderRange);
      }
      if (this._viewableIndices.length === viewableIndices.length && this._viewableIndices.every(function (v, ii) {
        return v === viewableIndices[ii];
      })) {
        return;
      }
      this._viewableIndices = viewableIndices;
      if (this._config.minimumViewTime) {
        var handle = setTimeout(function () {
          _this._timers.delete(handle);
          _this._onUpdateSync(props, viewableIndices, onViewableItemsChanged, createViewToken);
        }, this._config.minimumViewTime);
        this._timers.add(handle);
      } else {
        this._onUpdateSync(props, viewableIndices, onViewableItemsChanged, createViewToken);
      }
    }
  }, {
    key: "resetViewableIndices",
    value: function resetViewableIndices() {
      this._viewableIndices = [];
    }
  }, {
    key: "recordInteraction",
    value: function recordInteraction() {
      this._hasInteracted = true;
    }
  }, {
    key: "_onUpdateSync",
    value: function _onUpdateSync(props, viewableIndicesToCheck, onViewableItemsChanged, createViewToken) {
      var _this2 = this;
      viewableIndicesToCheck = viewableIndicesToCheck.filter(function (ii) {
        return _this2._viewableIndices.includes(ii);
      });
      var prevItems = this._viewableItems;
      var nextItems = new Map(viewableIndicesToCheck.map(function (ii) {
        var viewable = createViewToken(ii, true, props);
        return [viewable.key, viewable];
      }));
      var changed = [];
      for (var _ref2 of nextItems) {
        var _ref3 = (0, _slicedToArray2.default)(_ref2, 2);
        var key = _ref3[0];
        var viewable = _ref3[1];
        if (!prevItems.has(key)) {
          changed.push(viewable);
        }
      }
      for (var _ref4 of prevItems) {
        var _ref5 = (0, _slicedToArray2.default)(_ref4, 2);
        var _key = _ref5[0];
        var _viewable = _ref5[1];
        if (!nextItems.has(_key)) {
          changed.push(Object.assign({}, _viewable, {
            isViewable: false
          }));
        }
      }
      if (changed.length > 0) {
        this._viewableItems = nextItems;
        onViewableItemsChanged({
          viewableItems: Array.from(nextItems.values()),
          changed: changed,
          viewabilityConfig: this._config
        });
      }
    }
  }]);
  return ViewabilityHelper;
}();
function _isViewable(viewAreaMode, viewablePercentThreshold, top, bottom, viewportHeight, itemLength) {
  if (_isEntirelyVisible(top, bottom, viewportHeight)) {
    return true;
  } else {
    var pixels = _getPixelsVisible(top, bottom, viewportHeight);
    var percent = 100 * (viewAreaMode ? pixels / viewportHeight : pixels / itemLength);
    return percent >= viewablePercentThreshold;
  }
}
function _getPixelsVisible(top, bottom, viewportHeight) {
  var visibleHeight = Math.min(bottom, viewportHeight) - Math.max(top, 0);
  return Math.max(0, visibleHeight);
}
function _isEntirelyVisible(top, bottom, viewportHeight) {
  return top >= 0 && bottom <= viewportHeight && bottom > top;
}
module.exports = ViewabilityHelper;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpbnZhcmlhbnQiLCJyZXF1aXJlIiwiVmlld2FiaWxpdHlIZWxwZXIiLCJjb25maWciLCJ2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCIsIl9oYXNJbnRlcmFjdGVkIiwiX3RpbWVycyIsIlNldCIsIl92aWV3YWJsZUluZGljZXMiLCJfdmlld2FibGVJdGVtcyIsIk1hcCIsIl9jb25maWciLCJmb3JFYWNoIiwiY2xlYXJUaW1lb3V0IiwicHJvcHMiLCJzY3JvbGxPZmZzZXQiLCJ2aWV3cG9ydEhlaWdodCIsImdldEZyYW1lTWV0cmljcyIsInJlbmRlclJhbmdlIiwiaXRlbUNvdW50IiwiZ2V0SXRlbUNvdW50IiwiZGF0YSIsIml0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZCIsInZpZXdBcmVhTW9kZSIsInZpZXdhYmxlUGVyY2VudFRocmVzaG9sZCIsInZpZXdhYmxlSW5kaWNlcyIsImZpcnN0VmlzaWJsZSIsImZpcnN0IiwibGFzdCIsImNvbnNvbGUiLCJ3YXJuIiwiSlNPTiIsInN0cmluZ2lmeSIsImlkeCIsIm1ldHJpY3MiLCJ0b3AiLCJvZmZzZXQiLCJib3R0b20iLCJsZW5ndGgiLCJfaXNWaWV3YWJsZSIsInB1c2giLCJjcmVhdGVWaWV3VG9rZW4iLCJvblZpZXdhYmxlSXRlbXNDaGFuZ2VkIiwid2FpdEZvckludGVyYWN0aW9uIiwiY29tcHV0ZVZpZXdhYmxlSXRlbXMiLCJldmVyeSIsInYiLCJpaSIsIm1pbmltdW1WaWV3VGltZSIsImhhbmRsZSIsInNldFRpbWVvdXQiLCJkZWxldGUiLCJfb25VcGRhdGVTeW5jIiwiYWRkIiwidmlld2FibGVJbmRpY2VzVG9DaGVjayIsImZpbHRlciIsImluY2x1ZGVzIiwicHJldkl0ZW1zIiwibmV4dEl0ZW1zIiwibWFwIiwidmlld2FibGUiLCJrZXkiLCJjaGFuZ2VkIiwiaGFzIiwiaXNWaWV3YWJsZSIsInZpZXdhYmxlSXRlbXMiLCJBcnJheSIsImZyb20iLCJ2YWx1ZXMiLCJ2aWV3YWJpbGl0eUNvbmZpZyIsIml0ZW1MZW5ndGgiLCJfaXNFbnRpcmVseVZpc2libGUiLCJwaXhlbHMiLCJfZ2V0UGl4ZWxzVmlzaWJsZSIsInBlcmNlbnQiLCJ2aXNpYmxlSGVpZ2h0IiwiTWF0aCIsIm1pbiIsIm1heCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJWaWV3YWJpbGl0eUhlbHBlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgTWV0YSBQbGF0Zm9ybXMsIEluYy4gYW5kIGFmZmlsaWF0ZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKlxuICogQGZsb3dcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCB0eXBlIHtGcmFtZU1ldHJpY1Byb3BzfSBmcm9tICcuL1ZpcnR1YWxpemVkTGlzdFByb3BzJztcblxuY29uc3QgaW52YXJpYW50ID0gcmVxdWlyZSgnaW52YXJpYW50Jyk7XG5cbmV4cG9ydCB0eXBlIFZpZXdUb2tlbiA9IHtcbiAgaXRlbTogYW55LFxuICBrZXk6IHN0cmluZyxcbiAgaW5kZXg6ID9udW1iZXIsXG4gIGlzVmlld2FibGU6IGJvb2xlYW4sXG4gIHNlY3Rpb24/OiBhbnksXG4gIC4uLlxufTtcblxuZXhwb3J0IHR5cGUgVmlld2FiaWxpdHlDb25maWdDYWxsYmFja1BhaXIgPSB7XG4gIHZpZXdhYmlsaXR5Q29uZmlnOiBWaWV3YWJpbGl0eUNvbmZpZyxcbiAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZDogKGluZm86IHtcbiAgICB2aWV3YWJsZUl0ZW1zOiBBcnJheTxWaWV3VG9rZW4+LFxuICAgIGNoYW5nZWQ6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgLi4uXG4gIH0pID0+IHZvaWQsXG4gIC4uLlxufTtcblxuZXhwb3J0IHR5cGUgVmlld2FiaWxpdHlDb25maWcgPSB7fFxuICAvKipcbiAgICogTWluaW11bSBhbW91bnQgb2YgdGltZSAoaW4gbWlsbGlzZWNvbmRzKSB0aGF0IGFuIGl0ZW0gbXVzdCBiZSBwaHlzaWNhbGx5IHZpZXdhYmxlIGJlZm9yZSB0aGVcbiAgICogdmlld2FiaWxpdHkgY2FsbGJhY2sgd2lsbCBiZSBmaXJlZC4gQSBoaWdoIG51bWJlciBtZWFucyB0aGF0IHNjcm9sbGluZyB0aHJvdWdoIGNvbnRlbnQgd2l0aG91dFxuICAgKiBzdG9wcGluZyB3aWxsIG5vdCBtYXJrIHRoZSBjb250ZW50IGFzIHZpZXdhYmxlLlxuICAgKi9cbiAgbWluaW11bVZpZXdUaW1lPzogbnVtYmVyLFxuXG4gIC8qKlxuICAgKiBQZXJjZW50IG9mIHZpZXdwb3J0IHRoYXQgbXVzdCBiZSBjb3ZlcmVkIGZvciBhIHBhcnRpYWxseSBvY2NsdWRlZCBpdGVtIHRvIGNvdW50IGFzXG4gICAqIFwidmlld2FibGVcIiwgMC0xMDAuIEZ1bGx5IHZpc2libGUgaXRlbXMgYXJlIGFsd2F5cyBjb25zaWRlcmVkIHZpZXdhYmxlLiBBIHZhbHVlIG9mIDAgbWVhbnNcbiAgICogdGhhdCBhIHNpbmdsZSBwaXhlbCBpbiB0aGUgdmlld3BvcnQgbWFrZXMgdGhlIGl0ZW0gdmlld2FibGUsIGFuZCBhIHZhbHVlIG9mIDEwMCBtZWFucyB0aGF0XG4gICAqIGFuIGl0ZW0gbXVzdCBiZSBlaXRoZXIgZW50aXJlbHkgdmlzaWJsZSBvciBjb3ZlciB0aGUgZW50aXJlIHZpZXdwb3J0IHRvIGNvdW50IGFzIHZpZXdhYmxlLlxuICAgKi9cbiAgdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGQ/OiBudW1iZXIsXG5cbiAgLyoqXG4gICAqIFNpbWlsYXIgdG8gYHZpZXdBcmVhUGVyY2VudFRocmVzaG9sZGAsIGJ1dCBjb25zaWRlcnMgdGhlIHBlcmNlbnQgb2YgdGhlIGl0ZW0gdGhhdCBpcyB2aXNpYmxlLFxuICAgKiByYXRoZXIgdGhhbiB0aGUgZnJhY3Rpb24gb2YgdGhlIHZpZXdhYmxlIGFyZWEgaXQgY292ZXJzLlxuICAgKi9cbiAgaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkPzogbnVtYmVyLFxuXG4gIC8qKlxuICAgKiBOb3RoaW5nIGlzIGNvbnNpZGVyZWQgdmlld2FibGUgdW50aWwgdGhlIHVzZXIgc2Nyb2xscyBvciBgcmVjb3JkSW50ZXJhY3Rpb25gIGlzIGNhbGxlZCBhZnRlclxuICAgKiByZW5kZXIuXG4gICAqL1xuICB3YWl0Rm9ySW50ZXJhY3Rpb24/OiBib29sZWFuLFxufH07XG5cbi8qKlxuICogQSBVdGlsaXR5IGNsYXNzIGZvciBjYWxjdWxhdGluZyB2aWV3YWJsZSBpdGVtcyBiYXNlZCBvbiBjdXJyZW50IG1ldHJpY3MgbGlrZSBzY3JvbGwgcG9zaXRpb24gYW5kXG4gKiBsYXlvdXQuXG4gKlxuICogQW4gaXRlbSBpcyBzYWlkIHRvIGJlIGluIGEgXCJ2aWV3YWJsZVwiIHN0YXRlIHdoZW4gYW55IG9mIHRoZSBmb2xsb3dpbmdcbiAqIGlzIHRydWUgZm9yIGxvbmdlciB0aGFuIGBtaW5pbXVtVmlld1RpbWVgIG1pbGxpc2Vjb25kcyAoYWZ0ZXIgYW4gaW50ZXJhY3Rpb24gaWYgYHdhaXRGb3JJbnRlcmFjdGlvbmBcbiAqIGlzIHRydWUpOlxuICpcbiAqIC0gT2NjdXB5aW5nID49IGB2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZGAgb2YgdGhlIHZpZXcgYXJlYSBYT1IgZnJhY3Rpb24gb2YgdGhlIGl0ZW1cbiAqICAgdmlzaWJsZSBpbiB0aGUgdmlldyBhcmVhID49IGBpdGVtVmlzaWJsZVBlcmNlbnRUaHJlc2hvbGRgLlxuICogLSBFbnRpcmVseSB2aXNpYmxlIG9uIHNjcmVlblxuICovXG5jbGFzcyBWaWV3YWJpbGl0eUhlbHBlciB7XG4gIF9jb25maWc6IFZpZXdhYmlsaXR5Q29uZmlnO1xuICBfaGFzSW50ZXJhY3RlZDogYm9vbGVhbiA9IGZhbHNlO1xuICBfdGltZXJzOiBTZXQ8bnVtYmVyPiA9IG5ldyBTZXQoKTtcbiAgX3ZpZXdhYmxlSW5kaWNlczogQXJyYXk8bnVtYmVyPiA9IFtdO1xuICBfdmlld2FibGVJdGVtczogTWFwPHN0cmluZywgVmlld1Rva2VuPiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBjb25maWc6IFZpZXdhYmlsaXR5Q29uZmlnID0ge3ZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkOiAwfSxcbiAgKSB7XG4gICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAsIGUuZy4gb24gdW5tb3VudC4gQ2xlYXJzIGFueSBwZW5kaW5nIHRpbWVycy5cbiAgICovXG4gIGRpc3Bvc2UoKSB7XG4gICAgLyogJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF0gKD49MC42My4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzXG4gICAgICogY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC42MyB3YXMgZGVwbG95ZWQuIFRvIHNlZVxuICAgICAqIHRoZSBlcnJvciBkZWxldGUgdGhpcyBjb21tZW50IGFuZCBydW4gRmxvdy4gKi9cbiAgICB0aGlzLl90aW1lcnMuZm9yRWFjaChjbGVhclRpbWVvdXQpO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgd2hpY2ggaXRlbXMgYXJlIHZpZXdhYmxlIGJhc2VkIG9uIHRoZSBjdXJyZW50IG1ldHJpY3MgYW5kIGNvbmZpZy5cbiAgICovXG4gIGNvbXB1dGVWaWV3YWJsZUl0ZW1zKFxuICAgIHByb3BzOiBGcmFtZU1ldHJpY1Byb3BzLFxuICAgIHNjcm9sbE9mZnNldDogbnVtYmVyLFxuICAgIHZpZXdwb3J0SGVpZ2h0OiBudW1iZXIsXG4gICAgZ2V0RnJhbWVNZXRyaWNzOiAoXG4gICAgICBpbmRleDogbnVtYmVyLFxuICAgICAgcHJvcHM6IEZyYW1lTWV0cmljUHJvcHMsXG4gICAgKSA9PiA/e1xuICAgICAgbGVuZ3RoOiBudW1iZXIsXG4gICAgICBvZmZzZXQ6IG51bWJlcixcbiAgICAgIC4uLlxuICAgIH0sXG4gICAgLy8gT3B0aW9uYWwgb3B0aW1pemF0aW9uIHRvIHJlZHVjZSB0aGUgc2NhbiBzaXplXG4gICAgcmVuZGVyUmFuZ2U/OiB7XG4gICAgICBmaXJzdDogbnVtYmVyLFxuICAgICAgbGFzdDogbnVtYmVyLFxuICAgICAgLi4uXG4gICAgfSxcbiAgKTogQXJyYXk8bnVtYmVyPiB7XG4gICAgY29uc3QgaXRlbUNvdW50ID0gcHJvcHMuZ2V0SXRlbUNvdW50KHByb3BzLmRhdGEpO1xuICAgIGNvbnN0IHtpdGVtVmlzaWJsZVBlcmNlbnRUaHJlc2hvbGQsIHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkfSA9XG4gICAgICB0aGlzLl9jb25maWc7XG4gICAgY29uc3Qgdmlld0FyZWFNb2RlID0gdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGQgIT0gbnVsbDtcbiAgICBjb25zdCB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQgPSB2aWV3QXJlYU1vZGVcbiAgICAgID8gdmlld0FyZWFDb3ZlcmFnZVBlcmNlbnRUaHJlc2hvbGRcbiAgICAgIDogaXRlbVZpc2libGVQZXJjZW50VGhyZXNob2xkO1xuICAgIGludmFyaWFudChcbiAgICAgIHZpZXdhYmxlUGVyY2VudFRocmVzaG9sZCAhPSBudWxsICYmXG4gICAgICAgIChpdGVtVmlzaWJsZVBlcmNlbnRUaHJlc2hvbGQgIT0gbnVsbCkgIT09XG4gICAgICAgICAgKHZpZXdBcmVhQ292ZXJhZ2VQZXJjZW50VGhyZXNob2xkICE9IG51bGwpLFxuICAgICAgJ011c3Qgc2V0IGV4YWN0bHkgb25lIG9mIGl0ZW1WaXNpYmxlUGVyY2VudFRocmVzaG9sZCBvciB2aWV3QXJlYUNvdmVyYWdlUGVyY2VudFRocmVzaG9sZCcsXG4gICAgKTtcbiAgICBjb25zdCB2aWV3YWJsZUluZGljZXMgPSBbXTtcbiAgICBpZiAoaXRlbUNvdW50ID09PSAwKSB7XG4gICAgICByZXR1cm4gdmlld2FibGVJbmRpY2VzO1xuICAgIH1cbiAgICBsZXQgZmlyc3RWaXNpYmxlID0gLTE7XG4gICAgY29uc3Qge2ZpcnN0LCBsYXN0fSA9IHJlbmRlclJhbmdlIHx8IHtmaXJzdDogMCwgbGFzdDogaXRlbUNvdW50IC0gMX07XG4gICAgaWYgKGxhc3QgPj0gaXRlbUNvdW50KSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdJbnZhbGlkIHJlbmRlciByYW5nZSBjb21wdXRpbmcgdmlld2FiaWxpdHkgJyArXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe3JlbmRlclJhbmdlLCBpdGVtQ291bnR9KSxcbiAgICAgICk7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGZvciAobGV0IGlkeCA9IGZpcnN0OyBpZHggPD0gbGFzdDsgaWR4KyspIHtcbiAgICAgIGNvbnN0IG1ldHJpY3MgPSBnZXRGcmFtZU1ldHJpY3MoaWR4LCBwcm9wcyk7XG4gICAgICBpZiAoIW1ldHJpY3MpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBjb25zdCB0b3AgPSBtZXRyaWNzLm9mZnNldCAtIHNjcm9sbE9mZnNldDtcbiAgICAgIGNvbnN0IGJvdHRvbSA9IHRvcCArIG1ldHJpY3MubGVuZ3RoO1xuICAgICAgaWYgKHRvcCA8IHZpZXdwb3J0SGVpZ2h0ICYmIGJvdHRvbSA+IDApIHtcbiAgICAgICAgZmlyc3RWaXNpYmxlID0gaWR4O1xuICAgICAgICBpZiAoXG4gICAgICAgICAgX2lzVmlld2FibGUoXG4gICAgICAgICAgICB2aWV3QXJlYU1vZGUsXG4gICAgICAgICAgICB2aWV3YWJsZVBlcmNlbnRUaHJlc2hvbGQsXG4gICAgICAgICAgICB0b3AsXG4gICAgICAgICAgICBib3R0b20sXG4gICAgICAgICAgICB2aWV3cG9ydEhlaWdodCxcbiAgICAgICAgICAgIG1ldHJpY3MubGVuZ3RoLFxuICAgICAgICAgIClcbiAgICAgICAgKSB7XG4gICAgICAgICAgdmlld2FibGVJbmRpY2VzLnB1c2goaWR4KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmIChmaXJzdFZpc2libGUgPj0gMCkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHZpZXdhYmxlSW5kaWNlcztcbiAgfVxuXG4gIC8qKlxuICAgKiBGaWd1cmVzIG91dCB3aGljaCBpdGVtcyBhcmUgdmlld2FibGUgYW5kIGhvdyB0aGF0IGhhcyBjaGFuZ2VkIGZyb20gYmVmb3JlIGFuZCBjYWxsc1xuICAgKiBgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZGAgYXMgYXBwcm9wcmlhdGUuXG4gICAqL1xuICBvblVwZGF0ZShcbiAgICBwcm9wczogRnJhbWVNZXRyaWNQcm9wcyxcbiAgICBzY3JvbGxPZmZzZXQ6IG51bWJlcixcbiAgICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuICAgIGdldEZyYW1lTWV0cmljczogKFxuICAgICAgaW5kZXg6IG51bWJlcixcbiAgICAgIHByb3BzOiBGcmFtZU1ldHJpY1Byb3BzLFxuICAgICkgPT4gP3tcbiAgICAgIGxlbmd0aDogbnVtYmVyLFxuICAgICAgb2Zmc2V0OiBudW1iZXIsXG4gICAgICAuLi5cbiAgICB9LFxuICAgIGNyZWF0ZVZpZXdUb2tlbjogKFxuICAgICAgaW5kZXg6IG51bWJlcixcbiAgICAgIGlzVmlld2FibGU6IGJvb2xlYW4sXG4gICAgICBwcm9wczogRnJhbWVNZXRyaWNQcm9wcyxcbiAgICApID0+IFZpZXdUb2tlbixcbiAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiAoe1xuICAgICAgdmlld2FibGVJdGVtczogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIGNoYW5nZWQ6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICAuLi5cbiAgICB9KSA9PiB2b2lkLFxuICAgIC8vIE9wdGlvbmFsIG9wdGltaXphdGlvbiB0byByZWR1Y2UgdGhlIHNjYW4gc2l6ZVxuICAgIHJlbmRlclJhbmdlPzoge1xuICAgICAgZmlyc3Q6IG51bWJlcixcbiAgICAgIGxhc3Q6IG51bWJlcixcbiAgICAgIC4uLlxuICAgIH0sXG4gICk6IHZvaWQge1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IHByb3BzLmdldEl0ZW1Db3VudChwcm9wcy5kYXRhKTtcbiAgICBpZiAoXG4gICAgICAodGhpcy5fY29uZmlnLndhaXRGb3JJbnRlcmFjdGlvbiAmJiAhdGhpcy5faGFzSW50ZXJhY3RlZCkgfHxcbiAgICAgIGl0ZW1Db3VudCA9PT0gMCB8fFxuICAgICAgIWdldEZyYW1lTWV0cmljcygwLCBwcm9wcylcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgbGV0IHZpZXdhYmxlSW5kaWNlczogQXJyYXk8bnVtYmVyPiA9IFtdO1xuICAgIGlmIChpdGVtQ291bnQpIHtcbiAgICAgIHZpZXdhYmxlSW5kaWNlcyA9IHRoaXMuY29tcHV0ZVZpZXdhYmxlSXRlbXMoXG4gICAgICAgIHByb3BzLFxuICAgICAgICBzY3JvbGxPZmZzZXQsXG4gICAgICAgIHZpZXdwb3J0SGVpZ2h0LFxuICAgICAgICBnZXRGcmFtZU1ldHJpY3MsXG4gICAgICAgIHJlbmRlclJhbmdlLFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKFxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmxlbmd0aCA9PT0gdmlld2FibGVJbmRpY2VzLmxlbmd0aCAmJlxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmV2ZXJ5KCh2LCBpaSkgPT4gdiA9PT0gdmlld2FibGVJbmRpY2VzW2lpXSlcbiAgICApIHtcbiAgICAgIC8vIFdlIG1pZ2h0IGdldCBhIGxvdCBvZiBzY3JvbGwgZXZlbnRzIHdoZXJlIHZpc2liaWxpdHkgZG9lc24ndCBjaGFuZ2UgYW5kIHdlIGRvbid0IHdhbnQgdG8gZG9cbiAgICAgIC8vIGV4dHJhIHdvcmsgaW4gdGhvc2UgY2FzZXMuXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcyA9IHZpZXdhYmxlSW5kaWNlcztcbiAgICBpZiAodGhpcy5fY29uZmlnLm1pbmltdW1WaWV3VGltZSkge1xuICAgICAgY29uc3QgaGFuZGxlOiBUaW1lb3V0SUQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgLyogJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtY2FsbF0gKD49MC42My4wIHNpdGU9cmVhY3RfbmF0aXZlX2ZiKSBUaGlzXG4gICAgICAgICAqIGNvbW1lbnQgc3VwcHJlc3NlcyBhbiBlcnJvciBmb3VuZCB3aGVuIEZsb3cgdjAuNjMgd2FzIGRlcGxveWVkLiBUb1xuICAgICAgICAgKiBzZWUgdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgICB0aGlzLl90aW1lcnMuZGVsZXRlKGhhbmRsZSk7XG4gICAgICAgIHRoaXMuX29uVXBkYXRlU3luYyhcbiAgICAgICAgICBwcm9wcyxcbiAgICAgICAgICB2aWV3YWJsZUluZGljZXMsXG4gICAgICAgICAgb25WaWV3YWJsZUl0ZW1zQ2hhbmdlZCxcbiAgICAgICAgICBjcmVhdGVWaWV3VG9rZW4sXG4gICAgICAgICk7XG4gICAgICB9LCB0aGlzLl9jb25maWcubWluaW11bVZpZXdUaW1lKTtcbiAgICAgIC8qICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdICg+PTAuNjMuMCBzaXRlPXJlYWN0X25hdGl2ZV9mYikgVGhpc1xuICAgICAgICogY29tbWVudCBzdXBwcmVzc2VzIGFuIGVycm9yIGZvdW5kIHdoZW4gRmxvdyB2MC42MyB3YXMgZGVwbG95ZWQuIFRvIHNlZVxuICAgICAgICogdGhlIGVycm9yIGRlbGV0ZSB0aGlzIGNvbW1lbnQgYW5kIHJ1biBGbG93LiAqL1xuICAgICAgdGhpcy5fdGltZXJzLmFkZChoYW5kbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9vblVwZGF0ZVN5bmMoXG4gICAgICAgIHByb3BzLFxuICAgICAgICB2aWV3YWJsZUluZGljZXMsXG4gICAgICAgIG9uVmlld2FibGVJdGVtc0NoYW5nZWQsXG4gICAgICAgIGNyZWF0ZVZpZXdUb2tlbixcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIGNsZWFuLXVwIGNhY2hlZCBfdmlld2FibGVJbmRpY2VzIHRvIGV2YWx1YXRlIGNoYW5nZWQgaXRlbXMgb24gbmV4dCB1cGRhdGVcbiAgICovXG4gIHJlc2V0Vmlld2FibGVJbmRpY2VzKCkge1xuICAgIHRoaXMuX3ZpZXdhYmxlSW5kaWNlcyA9IFtdO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY29yZHMgdGhhdCBhbiBpbnRlcmFjdGlvbiBoYXMgaGFwcGVuZWQgZXZlbiBpZiB0aGVyZSBoYXMgYmVlbiBubyBzY3JvbGwuXG4gICAqL1xuICByZWNvcmRJbnRlcmFjdGlvbigpIHtcbiAgICB0aGlzLl9oYXNJbnRlcmFjdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIF9vblVwZGF0ZVN5bmMoXG4gICAgcHJvcHM6IEZyYW1lTWV0cmljUHJvcHMsXG4gICAgdmlld2FibGVJbmRpY2VzVG9DaGVjazogQXJyYXk8bnVtYmVyPixcbiAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkOiAoe1xuICAgICAgY2hhbmdlZDogQXJyYXk8Vmlld1Rva2VuPixcbiAgICAgIHZpZXdhYmxlSXRlbXM6IEFycmF5PFZpZXdUb2tlbj4sXG4gICAgICAuLi5cbiAgICB9KSA9PiB2b2lkLFxuICAgIGNyZWF0ZVZpZXdUb2tlbjogKFxuICAgICAgaW5kZXg6IG51bWJlcixcbiAgICAgIGlzVmlld2FibGU6IGJvb2xlYW4sXG4gICAgICBwcm9wczogRnJhbWVNZXRyaWNQcm9wcyxcbiAgICApID0+IFZpZXdUb2tlbixcbiAgKSB7XG4gICAgLy8gRmlsdGVyIG91dCBpbmRpY2VzIHRoYXQgaGF2ZSBnb25lIG91dCBvZiB2aWV3IHNpbmNlIHRoaXMgY2FsbCB3YXMgc2NoZWR1bGVkLlxuICAgIHZpZXdhYmxlSW5kaWNlc1RvQ2hlY2sgPSB2aWV3YWJsZUluZGljZXNUb0NoZWNrLmZpbHRlcihpaSA9PlxuICAgICAgdGhpcy5fdmlld2FibGVJbmRpY2VzLmluY2x1ZGVzKGlpKSxcbiAgICApO1xuICAgIGNvbnN0IHByZXZJdGVtcyA9IHRoaXMuX3ZpZXdhYmxlSXRlbXM7XG4gICAgY29uc3QgbmV4dEl0ZW1zID0gbmV3IE1hcChcbiAgICAgIHZpZXdhYmxlSW5kaWNlc1RvQ2hlY2subWFwKGlpID0+IHtcbiAgICAgICAgY29uc3Qgdmlld2FibGUgPSBjcmVhdGVWaWV3VG9rZW4oaWksIHRydWUsIHByb3BzKTtcbiAgICAgICAgcmV0dXJuIFt2aWV3YWJsZS5rZXksIHZpZXdhYmxlXTtcbiAgICAgIH0pLFxuICAgICk7XG5cbiAgICBjb25zdCBjaGFuZ2VkID0gW107XG4gICAgZm9yIChjb25zdCBba2V5LCB2aWV3YWJsZV0gb2YgbmV4dEl0ZW1zKSB7XG4gICAgICBpZiAoIXByZXZJdGVtcy5oYXMoa2V5KSkge1xuICAgICAgICBjaGFuZ2VkLnB1c2godmlld2FibGUpO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IFtrZXksIHZpZXdhYmxlXSBvZiBwcmV2SXRlbXMpIHtcbiAgICAgIGlmICghbmV4dEl0ZW1zLmhhcyhrZXkpKSB7XG4gICAgICAgIGNoYW5nZWQucHVzaCh7Li4udmlld2FibGUsIGlzVmlld2FibGU6IGZhbHNlfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjaGFuZ2VkLmxlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMuX3ZpZXdhYmxlSXRlbXMgPSBuZXh0SXRlbXM7XG4gICAgICBvblZpZXdhYmxlSXRlbXNDaGFuZ2VkKHtcbiAgICAgICAgdmlld2FibGVJdGVtczogQXJyYXkuZnJvbShuZXh0SXRlbXMudmFsdWVzKCkpLFxuICAgICAgICBjaGFuZ2VkLFxuICAgICAgICB2aWV3YWJpbGl0eUNvbmZpZzogdGhpcy5fY29uZmlnLFxuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIF9pc1ZpZXdhYmxlKFxuICB2aWV3QXJlYU1vZGU6IGJvb2xlYW4sXG4gIHZpZXdhYmxlUGVyY2VudFRocmVzaG9sZDogbnVtYmVyLFxuICB0b3A6IG51bWJlcixcbiAgYm90dG9tOiBudW1iZXIsXG4gIHZpZXdwb3J0SGVpZ2h0OiBudW1iZXIsXG4gIGl0ZW1MZW5ndGg6IG51bWJlcixcbik6IGJvb2xlYW4ge1xuICBpZiAoX2lzRW50aXJlbHlWaXNpYmxlKHRvcCwgYm90dG9tLCB2aWV3cG9ydEhlaWdodCkpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICBjb25zdCBwaXhlbHMgPSBfZ2V0UGl4ZWxzVmlzaWJsZSh0b3AsIGJvdHRvbSwgdmlld3BvcnRIZWlnaHQpO1xuICAgIGNvbnN0IHBlcmNlbnQgPVxuICAgICAgMTAwICogKHZpZXdBcmVhTW9kZSA/IHBpeGVscyAvIHZpZXdwb3J0SGVpZ2h0IDogcGl4ZWxzIC8gaXRlbUxlbmd0aCk7XG4gICAgcmV0dXJuIHBlcmNlbnQgPj0gdmlld2FibGVQZXJjZW50VGhyZXNob2xkO1xuICB9XG59XG5cbmZ1bmN0aW9uIF9nZXRQaXhlbHNWaXNpYmxlKFxuICB0b3A6IG51bWJlcixcbiAgYm90dG9tOiBudW1iZXIsXG4gIHZpZXdwb3J0SGVpZ2h0OiBudW1iZXIsXG4pOiBudW1iZXIge1xuICBjb25zdCB2aXNpYmxlSGVpZ2h0ID0gTWF0aC5taW4oYm90dG9tLCB2aWV3cG9ydEhlaWdodCkgLSBNYXRoLm1heCh0b3AsIDApO1xuICByZXR1cm4gTWF0aC5tYXgoMCwgdmlzaWJsZUhlaWdodCk7XG59XG5cbmZ1bmN0aW9uIF9pc0VudGlyZWx5VmlzaWJsZShcbiAgdG9wOiBudW1iZXIsXG4gIGJvdHRvbTogbnVtYmVyLFxuICB2aWV3cG9ydEhlaWdodDogbnVtYmVyLFxuKTogYm9vbGVhbiB7XG4gIHJldHVybiB0b3AgPj0gMCAmJiBib3R0b20gPD0gdmlld3BvcnRIZWlnaHQgJiYgYm90dG9tID4gdG9wO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IFZpZXdhYmlsaXR5SGVscGVyO1xuIl0sIm1hcHBpbmdzIjoiQUFVQSxZQUFZOztBQUFD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